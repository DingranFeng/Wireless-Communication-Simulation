function Tsignal = QAM64_modulation(Tdata)
%%%64QAM调制
%%%输入参数为二进制数据，输出参数为基带发射信号
d = sqrt(2/21); %星座图上相邻两点距离
Map = [-3.5*d+3.5*d*1i -2.5*d+3.5*d*1i -1.5*d+3.5*d*1i -0.5*d+3.5*d*1i 0.5*d+3.5*d*1i 1.5*d+3.5*d*1i 2.5*d+3.5*d*1i 3.5*d+3.5*d*1i...
    -3.5*d+2.5*d*1i -2.5*d+2.5*d*1i -1.5*d+2.5*d*1i -0.5*d+2.5*d*1i 0.5*d+2.5*d*1i 1.5*d+2.5*d*1i 2.5*d+2.5*d*1i 3.5*d+2.5*d*1i...
    -3.5*d+1.5*d*1i -2.5*d+1.5*d*1i -1.5*d+1.5*d*1i -0.5*d+1.5*d*1i 0.5*d+1.5*d*1i 1.5*d+1.5*d*1i 2.5*d+1.5*d*1i 3.5*d+1.5*d*1i...
    -3.5*d+0.5*d*1i -2.5*d+0.5*d*1i -1.5*d+0.5*d*1i -0.5*d+0.5*d*1i 0.5*d+0.5*d*1i 1.5*d+0.5*d*1i 2.5*d+0.5*d*1i 3.5*d+0.5*d*1i...
    -3.5*d-0.5*d*1i -2.5*d-0.5*d*1i -1.5*d-0.5*d*1i -0.5*d-0.5*d*1i 0.5*d-0.5*d*1i 1.5*d-0.5*d*1i 2.5*d-0.5*d*1i 3.5*d-0.5*d*1i...
    -3.5*d-1.5*d*1i -2.5*d-1.5*d*1i -1.5*d-1.5*d*1i -0.5*d-1.5*d*1i 0.5*d-1.5*d*1i 1.5*d-1.5*d*1i 2.5*d-1.5*d*1i 3.5*d-1.5*d*1i...
    -3.5*d-2.5*d*1i -2.5*d-2.5*d*1i -1.5*d-2.5*d*1i -0.5*d-2.5*d*1i 0.5*d-2.5*d*1i 1.5*d-2.5*d*1i 2.5*d-2.5*d*1i 3.5*d-2.5*d*1i...
    -3.5*d-3.5*d*1i -2.5*d-3.5*d*1i -1.5*d-3.5*d*1i -0.5*d-3.5*d*1i 0.5*d-3.5*d*1i 1.5*d-3.5*d*1i 2.5*d-3.5*d*1i 3.5*d-3.5*d*1i];
MapTable = [0 0 0 0 0 0;0 0 0 0 0 1;0 0 0 0 1 1;0 0 0 0 1 0;0 0 0 1 1 0;0 0 0 1 1 1;0 0 0 1 0 1;0 0 0 1 0 0;
    0 0 1 1 0 0;0 0 1 1 0 1;0 0 1 1 1 1;0 0 1 1 1 0;0 0 1 0 1 0;0 0 1 0 1 1;0 0 1 0 0 1;0 0 1 0 0 0;
    0 1 1 0 0 0;0 1 1 0 0 1;0 1 1 0 1 1;0 1 1 0 1 0;0 1 1 1 1 0;0 1 1 1 1 1;0 1 1 1 0 1;0 1 1 1 0 0;
    0 1 0 1 0 0;0 1 0 1 0 1;0 1 0 1 1 1;0 1 0 1 1 0;0 1 0 0 1 0;0 1 0 0 1 1;0 1 0 0 0 1;0 1 0 0 0 0;
    1 1 0 0 0 0;1 1 0 0 0 1;1 1 0 0 1 1;1 1 0 0 1 0;1 1 0 1 1 0;1 1 0 1 1 1;1 1 0 1 0 1;1 1 0 1 0 0;
    1 1 1 1 0 0;1 1 1 1 0 1;1 1 1 1 1 1;1 1 1 1 1 0;1 1 1 0 1 0;1 1 1 0 1 1;1 1 1 0 0 1;1 1 1 0 0 0;
    1 0 1 0 0 0;1 0 1 0 0 1;1 0 1 0 1 1;1 0 1 0 1 0;1 0 1 1 1 0;1 0 1 1 1 1;1 0 1 1 0 1;1 0 1 1 0 0;
    1 0 0 1 0 0;1 0 0 1 0 1;1 0 0 1 1 1;1 0 0 1 1 0;1 0 0 0 1 0;1 0 0 0 1 1;1 0 0 0 0 1;1 0 0 0 0 0]; %格雷码比特映射表
datanum = length(Tdata);   %二进制数据总数
Tsignal = zeros(datanum/6,1);	%发射信号
for i = 1:datanum/6
    for j = 1:64
        if isequal(Tdata(6*i-5:6*i),MapTable(j,:))
            Tsignal(i) = Map(j);  %产生复信号
            break;
        end
    end
end
end

        